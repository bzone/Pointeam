<!DOCTYPE html>
<!-- CSP support mode (required for Windows Universal apps): https://docs.angularjs.org/api/ng/directive/ngCsp -->
<html lang="en" ng-app="app" ng-csp>

<head>
    <meta charset="utf-8" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <!-- JS dependencies (order matters!) -->
    <script src="scripts/platformOverrides.js"></script>
    <script src="lib/angular/angular.js"></script>
    <script src="lib/onsen/js/onsenui.js"></script>
    <!-- CSS dependencies -->
    <link rel="stylesheet" href="css/index.css" />
    <link rel="stylesheet" href="lib/onsen/css/onsenui.css" />
    <link rel="stylesheet" href="lib/onsen/css/onsen-css-components.css" />
    <!-- CSP support mode (required for Windows Universal apps) -->
    <link rel="stylesheet" href="lib/angular/angular-csp.css" />
    <!-- --------------- App init --------------- -->
    <script src="js/app.js"></script>
    <title>Pointeam</title>
</head>

<body ng-controller="AppController">
    <!-- Cordova reference -->
    <script src="cordova.js"></script>
    <script src="js/jquery.js"></script>
    <script src="js/jquery.easypiechart.js"></script>
    <script src="scripts/index.js"></script>
    <!-- -->
    <style>
        .item {
            padding: 0px;
            line-height: 1;
        }
        
        .item-thum {
            background-color: #ccc;
            width: 50px;
            height: 50px;
            border-radius: 4px;
        }
        
        .item-title {
            font-size: 15px;
            font-weight: 500;
        }
        
        .item-desc {
            font-size: 14px;
            color: #666;
            line-height: 1.3;
            margin: 4px 0 0 0;
            padding: 0 30px 0 0;
        }
        
        .item-label {
            font-size: 12px;
            color: #999;
            float: right;
        }
    </style>
    <div class="spinner" id="spinner" style="display:none;">
        <div id="spinnerOk" style="display:none;"><i class="ion-checkmark-round"></i></div>
                <div id="spinnerIcon"></div>
    </div>
    <div class="over" id="timer" style="display:none;">
        <div class="timerHolder">
            <div class="stopTimer"><i class="icon ion-close-circled"></i></div>
           <div class="clockAnimation"></div>
            <div class="clockAnimationBg"></div>
            <div id="clockTaskName"></div>
            <div id="clockdiv"></div>
        </div>
    </div>

    <div class="commentForm" id="commentForm" style="display:none;">
        <div class="inputHolder">
            <input type="text" id="newComment"></input>
            <div class="acceptButton" ng-click="addCommentGlobal()">OK</div>
        </div>

    </div>

    <ons-navigator var="navi">
        <ons-page style="background:#31198B !Important;" ng-init="checkLogin()">

            <div class="bigLogo"></div>
            <form class="loginStyle">
                <input type="email" id="loginEmail" class="loginInputStyle" placeholder="e-mail" />
                <input type="password" id="loginPassword" class="loginInputStyle" placeholder="hasło" />
                <a class="submitButton" ng-click="loginUser()">Zaloguj się</a>
                <br/>
                <span class="lub">lub</span>
                <a class="submitButton" onclick="navi.pushPage('register.html', { animation : 'slide' } )">Utwórz nowe konto</a>
                <br/>
                <a class="passwordReset" onclick="navi.pushPage('recovery.html', { animation : 'slide' } )">zapomniałeś hasła?</a>
            </form>
        </ons-page>
    </ons-navigator>


    <ons-template id="register.html">
        
        <ons-page style="background:#31198B !Important;" >
           <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="navi.popPage();">
                    <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
            <div class="bigLogo logoMargin"></div>
            <form class="loginStyle">
                <input type="text" id="newUserName" class="loginInputStyle" placeholder="imię" />
                <input type="text" id="newUserSurName" class="loginInputStyle" placeholder="nazwisko" />
                <input type="email" id="newUserEmail" class="loginInputStyle" placeholder="e-mail" />
                <input type="password" id="newUserPassword" class="loginInputStyle" placeholder="hasło" />
                <a class="submitButton" ng-click="registerUser()" >Utwórz konto i zaloguj</a>
                <br/>
            </form>
        </ons-page>
    </ons-template>


    <ons-template id="recovery.html">
        <ons-page style="background:#31198B !Important;">
           <ons-toolbar>
            <div class="left">
                <ons-toolbar-button onclick="navi.popPage();">
                    <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                </ons-toolbar-button>
            </div>
        </ons-toolbar>
            <div class="bigLogo logoMargin"></div>
            <form class="loginStyle">
                <p class="recover">Podaj adres e-mail powiązany z Twoim kontem. <br/>Na podany adres otrzymasz przypomnienia swojego hasła.</p>
                <br/>
                <input type="email" id="recoverEmail" class="loginInputStyle" placeholder="twój e-mail" />
                <a class="submitButton" ng-click="recoverPassword()">zresetuj hasło</a>
                <br/>
            </form>
        </ons-page>
    </ons-template>

    <ons-template id="home.html">
        <ons-page>
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.pushPage('settings.html', { animation : 'lift' } )">
                        <ons-icon icon="ion-gear-a" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center"><span class="logo"></span>
                </div>
                <div class="right">
                    <ons-toolbar-button id="goToDashboard">
                        <ons-icon icon="ion-speedometer" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                    <ons-toolbar-button id="goToList" style="display:none;">
                        <ons-icon icon="ion-navicon-round" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                    <ons-toolbar-button onclick="projectCreated++;navi.pushPage('newproject.html', { animation : 'slide' } );">
                        <ons-icon icon="ion-plus-round" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <ons-carousel swipeable overscrollable auto-scroll auto-refresh fullscreen var="carousel" ng-controller="MasterController" class="tabDashboard" style="overflow:hidden; height:0px;">
                <ons-carousel-item style="background-color: #32188f;" class="item" ng-repeat="item in items" ng-click="showDetail($index)">
                    <div class="relativeBox">
                        <div class="ownerInfo">
                            <div class="person avatarUser" style="background-image:url('{{item.avatarAdmina}}');"></div>
                            <div class="projectTitleAuthor">
                                <span class="title">{{item.tytul}}</span>
                                <!-- <span class="author">Admin: {{item.avatarAdmina}}</span> -->
                            </div>
                        </div>
                        <span class="chart" data-percent="{{item.procentUkonczeniaProjektu}}">
		                    <span class="percent"></span>
                        <br/>
                        <span class="number">{{item.ukonczoneZadania}}/{{item.wszystkieZadania}}</span>
                        <h4>ukończonych<br/>zadań</h4>
                        </span>
                        <div class="projectFooter">
                            <div class="infoElements">
                                <div class='icon {{item.statusClass}}'>{{item.statusUzytkownika}}</div>
                                <div class='icon time'>{{item.czasUzytkownika}}</div>
                                <div class='icon cost'>{{item.kasaUzytkownika}}</div>
                                <div class='icon promo'>{{item.punktyUzytkownika}}</div>
                            </div>
                            <div class="clear"></div>
                            <br/>
                            <div class="yourStats">
                                Zadania przypisane do Ciebie: <span class="colorYellow">{{item.zadaniaPrzypisaneDoUzytkownika}}</span>
                                <br/> Zadania nieprzypisane: <span class="colorYellow">{{item.zadaniaNieprzypisane}}</span>
                                <br/> Najbliższy termin: <span class="colorYellow">{{item.terminy[0].data}}</span>
                                <br/>
                            </div>
                            <br/>
                            <h4>zadania przypisane do inncyh osób</h4>
                            <div class="projectPeople">
                                <meta name="format-detection" content="telephone=no">


                                <span ng-repeat="osoba in item.przypisaneOsoby | limitTo: 5">
                                <div class="person" style="background-image:url('{{ osoba.avatar }}');">
                                    <div class="badge">{{ osoba.iloscZadan }}</div>
                                </div>
                                </span>
                            </div>
                        </div>
                    </div>
                </ons-carousel-item>
            </ons-carousel>
            <ons-tapbar position="top" class="homeTabs" ng-controller="MasterController" >
                <div class="tab-bar tab-bar--top tab-bar--top-border">
                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToProjekty()">
                        <input type="radio" name="top-tab-bar-b" checked="checked">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Projekty
                        </button>
                    </label>

                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToMojeZadania()">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Moje zadania
                        </button>
                    </label>
                </div>
            </ons-tapbar>
            <ons-list ng-controller="MasterController" style="display:block;" class="tabProjekty">
                <ons-list-item modifier="chevron" class="item" ng-repeat="item in items" ng-click="showDetail($index)">
                    <ons-row>
                        <ons-col>
                            <div class="basicItem project">
                                <div class="avatarHolder">
                                    <div class="person" style="background-image:url('{{item.avatarAdmina}}');"></div>
                                </div>
                                <div class="statusHolder">
                                    <div class="statusItem notificationsCount" style="display:{{item.notyfikacjeDisplay}};">{{item.notyfikacje}}</div>
                                </div>
                                <div class="chartHolder">
                                    <span class="chartMini" data-percent="{{item.procentUkonczeniaProjektu}}">
		                    <span class="percent"></span>
                                    <br/>
                                    </span>
                                </div>
                                <div class="taskTitle">{{item.tytul}}</div>
                                <div class="infoElements">
                                    <div class='icon {{item.statusClass}}'>{{item.statusUzytkownika}}</div>
                                    <div class='icon time'>{{item.czasUzytkownika}}</div>
                                    <div class='icon cost'>{{item.kasaUzytkownika}}</div>
                                    <div class='icon promo'>{{item.punktyUzytkownika}}</div>
                                </div>
                                <div class="normalStats">
                                    Zadania przypisane do Ciebie: {{item.zadaniaPrzypisaneDoUzytkownika}}
                                    <br/> Zadania nieprzypisane: {{item.zadaniaNieprzypisane}}
                                    <br/> Najbliższy termin: {{item.terminy[0].data}}
                                </div>
                            </div>
                        </ons-col>
                    </ons-row>
                </ons-list-item>
            </ons-list>
            <ons-list ng-controller="MasterController" style="display:none;" class="tabMojeZadania">
                    <ons-list-item modifier="chevron" class="item" ng-repeat="zadanie in user.tasks | orderBy:'orderKey'" ng-click="showDetail($index)" ng-if="zadanie.priorytet!='prioFinished'">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem myTask" style="display:{{zadanie.basicItem}};">
                                    <div class="dateHolder {{zadanie.priorytet}}">
                                        <div class="day">{{zadanie.dataDzien}}</div>
                                        <div class="mounth">{{zadanie.dataMiesiac}}</div>
                                        <div class="hour">{{zadanie.dataGodzina}}</div>
                                    </div>
                                    <div class="statusHolder">
                                        <div class="statusItem notificationsCount" style="display:{{zadanie.notyfikacjeDisplay}};">{{zadanie.notyfikacje}}</div>
                                        <div class="statusItem location" style="display:{{zadanie.lokalizacjaDisplay}};"></div>
                                        
                                       
                                    </div>
                                    <div class="statusHolder">
                                        <div class="statusItem notificationsCount" style="display:{{zadanie.notyfikacjeDisplay}};">{{zadanie.notyfikacje}}</div>
                                    </div>

                                    <div class="taskTitle">{{zadanie.nazwa}}</div>
                                    <div class="smallProjectTitle">{{zadanie.tytul}}</div>
                                    <div class="infoElements">
                                        <div class='icon {{zadanie.statusClass}}'>{{zadanie.statusUzytkownika}}</div>
                                        <div class='icon time'>{{zadanie.czasUzytkownika}}</div>
                                        <div class='icon cost'>{{zadanie.kasaUzytkownika}}</div>
                                        <div class='icon promo'>{{zadanie.punktyUzytkownika}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
            </ons-list>
           
        </ons-page>
    </ons-template>
    //FUTURE: Ekran pojedyncze zadania
    <ons-template id="singleTask.html">
        <ons-page ng-controller="SingleTask" ng-init="RebuildTerms()">

            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button ng-click="closeSingleTask()">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">{{shortname}}</div>
                <div class="right">
                    <ons-toolbar-button ng-if="item.ukonczoneDisplay=='none' && isUserIn(item.idZadania, projekt.idProjekt, currentuser[0].idUser)">
                        <ons-icon icon="ion-android-time" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="startTimer(item.idZadania, projekt.idProjekt, currentuser[0].idUser)"></ons-icon>
                    </ons-toolbar-button>
                    <ons-toolbar-button ng-if="item.ukonczoneDisplay=='none' && isUserIn(item.idZadania, projekt.idProjekt, currentuser[0].idUser)">
                        <ons-icon icon="ion-checkmark-circled" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="markAsComplete(item.idZadania, projekt.idProjekt)"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <ons-tapbar position="top" class="homeTabs">
                <div class="tab-bar tab-bar--top tab-bar--top-border">
                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToInformacje()">
                        <input type="radio" name="top-tab-bar-b" checked="checked">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Informacje
                        </button>
                    </label>
                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToKomentarze()">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Komentarze
                        </button>
                    </label>
                </div>
            </ons-tapbar>
            <div id="informacjeTab">
                <ons-col ng-click="showTask(item.idZadania)">
                    <div class="basicItem subtask single" style="display:{{item.basicItem}};">
                        <div class="avatarHolder">
                            <div class="person" style="background-image:url({{item.avatarPierwszejOsoby}})"></div>
                            <div class="clear"></div>
                            <div class="dodatkoweOsoby" style="display:{{item.dodatkoweOsobyDisplay}};">+{{item.dotatkoweOsoby}}</div>
                        </div>
                        <div class="dateHolder {{item.priorytet}}">
                            <div class="day">{{item.dataDzien}}</div>
                            <div class="mounth">{{item.dataMiesiac}}</div>
                            <div class="hour">{{item.dataGodzina}}</div>
                        </div>
                        <div class="statusHolder">
                            <div class="statusItem notificationsCount" style="display:{{item.notyfikacjeDisplay}};">{{item.notyfikacje}}</div>
                            <div class="statusItem location" style="display:{{item.lokalizacjaDisplay}};"></div>
                            <div class="statusItem done" style="display:{{item.ukonczoneDisplay}};"></div>
                            <div class="statusItem noPerson" style="display:{{item.brakOsobyDisplay}};"></div>
                        </div>
                        <div class="statusHolder">
                            <div class="statusItem notificationsCount" style="display:{{item.notyfikacjeDisplay}};">{{item.notyfikacje}}</div>
                        </div>

                        <div class="taskTitle" style="margin-bottom:-10px;">{{item.nazwa}}</div>
                        <div class="infoElements">
                            <div class='icon {{zadanie.statusClass}}'>{{item.statusUzytkownika}}</div>
                            <div class='icon time'>{{item.czasUzytkownika}}</div>
                            <div class="clear" style="margin-bottom:5px;"></div>
                            <div class='icon cost'>{{item.kasaUzytkownika}}</div>
                            <div class='icon promo'>{{item.punktyUzytkownika}}</div>
                        </div>
                    </div>
                    <div class="basicItem subtask more" style="display:{{item.basicItem}};">
                        <div class="dateHolder {{item.priorytet}}">
                        </div>
                        <div class="singleSection" ng-if="item.opis.length>1 || item.lokalizacja!='Wybierz lokalizację'">
                            <div ng-if="item.opis">
                                <h3>Opis zadania</h3>
                                <p class="opis">{{item.opis}}</p>
                            </div>
                            <div class="locationBig" ng-if="item.lokalizacja!='Wybierz lokalizację'">
                                <h3>Lokalizacja:</h3>
                                <div id="adressPreview" data-ng-bind-html="someSafeContent"></div>
                            </div>
                        </div>
                        <div class="singleSection">
                            <h3>Data ukończenia i priorytet</h3>
                            <div class="singleRow">
                                <div class="milestoneHeader" ng-if="milestoneName.mileStoneNaglowek">{{milestoneName.mileStoneNaglowek}}</div>
                                <div class="milerstoneDate">{{item.data}}</div>
                                <div class="milerstoneDes">{{item.nazwa}}</div>
                                <span class="priorytet done" ng-if="item.priorytet=='prioFinished'">Zadanie zakończone</span>
                                <span class="priorytet low" ng-if="item.priorytet=='prioLow'">Priorytet niski</span>
                                <span class="priorytet normal" ng-if="item.priorytet=='prioNormal'">Priorytet normalny</span>
                                <span class="priorytet important" ng-if="item.priorytet=='prioImportant'">Priorytet wysoki</span>
                            </div>
                        </div>
                        <div class="singleSection">
                            <h3>Budżet zadania</h3>
                            <div class="chartsBig" id="taskCharts">
                                <div class="half" ng-if="item.budzetGodzinowy=='tak'">
                                    <span class="chartHours" data-percent="{{item.budzetGodzinowyWykorzystanie/item.budzetGodzinowyWartosc*100}}">
		                    <span class="percent"></span>
                                    <div class="clear"></div>
                                    <span class="detail">{{item.budzetGodzinowyWykorzystanie/60 | number: 2}}/{{item.budzetGodzinowyWartosc/60 | number: 0}}</span>
                                    </span>
                                    <div class="chartLabel">przepracowanych
                                        <br/>godzin</div>
                                </div>
                                <div class="half" ng-if="item.budzetGodzinowy!='tak'">
                                    <span class="chartHours" data-percent="0">
		                    <span class="value">{{item.budzetGodzinowyWykorzystanie/60 | number: 2}}</span>
                                    <div class="clear"></div>

                                    </span>
                                    <div class="chartLabel">przepracowanych
                                        <br/>godzin</div>
                                </div>
                                <div class="half" ng-if="item.budzetPieniezny=='tak'">
                                    <span class="chartMoney" data-percent="{{item.budzetPienieznyWykorzystanie/item.budzetPienieznyWartosc*100}}">
		                    <span class="percent"></span>
                                    <div class="clear"></div>
                                    <span class="detail">{{item.budzetPienieznyWykorzystanie/100 | number :2}}/{{item.budzetPienieznyWartosc/100 | number: 0}}</span>
                                    </span>
                                    <div class="chartLabel">wykorzystane
                                        <br/>pieniądze</div>
                                </div>
                                <div class="half" ng-if="item.budzetPieniezny!='tak'">
                                    <span class="chartMoney" data-percent="0">
		                    <span class="value">{{item.budzetPienieznyWykorzystanie/100 | number: 2}}zł</span>
                                    <div class="clear"></div>
                                    </span>
                                    <div class="chartLabel">wykorzystane
                                        <br/>pieniądze</div>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </div>
                        <div class="singleSection">
                            <h3 ng-if="!item.przypisaneOsoby || item.przypisaneOsoby.length==0">Przypisane osoby: brak</h3>
                            <div class="text-center" ng-if="!item.przypisaneOsoby || item.przypisaneOsoby.length==0">
                                <div id="dodajSiebie" ng-click="addUserToTask(currentuser[0].idUser,item.idZadania)"> przyjmij zadanie {{currentuser[0].idUser}}</div>
                            </div>
                            <h3 ng-if="item.przypisaneOsoby && item.przypisaneOsoby.length>0">Przypisane osoby: {{item.przypisaneOsoby.length}}</h3>
                            <ons-list-item ng-if="item.przypisaneOsoby && item.przypisaneOsoby.length>0" modifier="chevron" class="item osoba" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-imie'" data-person="{{osoba.idUser}}">
                                <ons-row>
                                    <ons-col>
                                        <div class="basicItem logItem">
                                            <div class="avatarHolder" style="left:12px;">
                                                <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                                <div class="clear"></div>
                                            </div>
                                            <div ng-if="userAddedToTemp(osoba.idUser)" class="checkHolder"><i class="icon ion-android-cancel"></i></div>
                                            <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                            <div class="infoElements">
                                                <div class='icon cost'>{{osoba.stawka/100 | number:0}} zł/h</div>
                                            </div>
                                        </div>
                                    </ons-col>
                                </ons-row>
                            </ons-list-item>
                        </div>
                    </div>
                </ons-col>
            </div>
            <div id="komentarzeTab" style="display:none; overflow:hidden; background-color:#FFF;">
                <!-- NOTE: NOw point -->
                <div class="komentarz" ng-repeat="komentarz in item.komentarze">
                    <div class="lewy" ng-if="komentarz.admin==1">
                        <div class="avatarHolder" style="left:12px;">
                            <div class="person" style="background-image:url({{komentarz.avatar}})"></div>
                        </div>
                        <div class="arrow"></div>
                        <div class="tooltip">
                            <p>{{komentarz.text}}</p>
                            <div class="infoElements">
                                <div class='icon none'>{{komentarz.autor}}</div>
                                <div class='icon time'>{{komentarz.data}}</div>
                            </div>
                        </div>
                    </div>
                    <div class="prawy" ng-if="komentarz.admin==0">
                        <div class="avatarHolder" style="left:12px;">
                            <div class="person" style="background-image:url({{komentarz.avatar}})"></div>
                        </div>
                        <div class="arrow"></div>
                        <div class="tooltip">
                            <p>{{komentarz.text}}</p>
                            <div class="infoElements">
                                <div class='icon none'>{{komentarz.autor}}</div>
                                <div class='icon time'>{{komentarz.data}}</div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </ons-page>
    </ons-template>
    //FUTURE: Ekran widok projektu
    <ons-template id="procjectview.html">
        <ons-page ng-controller="DetailController" ng-init="RebuildTerms()">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="if(projectCreated==1){projectCreated=0;navi.getPages()[3].destroy();navi.popPage();} else { navi.popPage(); }">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">{{item.krotkitytul}}</div>
                <div class="right">
                    <ons-toolbar-button id="projectOptions" ng-if="!item.zamkniety && isAdmin(item.idProjekt)">
                        <ons-icon icon="ion-more" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="projectOptions()"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <ons-tapbar position="top" class="homeTabs" ng-if="isAdmin(item.idProjekt)">
                <div class="tab-bar tab-bar--top tab-bar--top-border">
                    <label class="tab-bar__item tab-bar--top-border__item" id="goToZadania">
                        <input type="radio" name="top-tab-bar-b" checked="checked">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Zadania
                        </button>
                    </label>
                    <label class="tab-bar__item tab-bar--top-border__item" id="goToBudzet">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Budżet
                        </button>
                    </label>
                    <label class="tab-bar__item tab-bar--top-border__item" id="goToPostep">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Postęp
                        </button>
                    </label>
                </div>
            </ons-tapbar>
              <ons-tapbar position="top" class="homeTabs" ng-if="!isAdmin(item.idProjekt)">
                <div class="tab-bar tab-bar--top tab-bar--top-border">
                    <label class="tab-bar__item tab-bar--top-border__item" id="goToZadania">
                        <input type="radio" name="top-tab-bar-b" checked="checked">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Zadania
                        </button>
                    </label>
                    <label class="tab-bar__item tab-bar--top-border__item" id="goToStatystyki">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Statystyki
                        </button>
                    </label>
                </div>
            </ons-tapbar>
            <div ng-if="!item.zadania" class="emptyAll">
                <div class="emptyState"></div>
                <div id="newTask" style="display:none;">Dodaj zadanie</div>
            </div>
            <ons-list style="display:block;" class="tabZadania" id="tabZadania">
                <ons-list-item modifier="chevron" class="item" ng-repeat="zadanie in item.zadania | orderBy:'orderKey'">
                    <ons-row>
                        <ons-col ng-if="zadanie.basicItem=='block'" ng-click="showTask(zadanie.idZadania)">
                            <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                <div class="avatarHolder">
                                    <div class="person" style="background-image:url({{zadanie.avatarPierwszejOsoby}})"></div>
                                    <div class="clear"></div>
                                    <div class="dodatkoweOsoby" style="display:{{zadanie.dodatkoweOsobyDisplay}};">+{{zadanie.dotatkoweOsoby}}</div>
                                </div>
                                <div class="dateHolder {{zadanie.priorytet}}">
                                    <div class="day">{{zadanie.dataDzien}}</div>
                                    <div class="mounth">{{zadanie.dataMiesiac}}</div>
                                    <div class="hour">{{zadanie.dataGodzina}}</div>
                                </div>
                                <div class="statusHolder">
                                    <div class="statusItem notificationsCount" style="display:{{zadanie.notyfikacjeDisplay}};">{{zadanie.notyfikacje}}</div>
                                    <div class="statusItem location" style="display:{{zadanie.lokalizacjaDisplay}};"></div>
                                    <div class="statusItem done" style="display:{{zadanie.ukonczoneDisplay}};"></div>
                                    <div class="statusItem noPerson" style="display:{{zadanie.brakOsobyDisplay}};"></div>
                                </div>
                                <div class="statusHolder">
                                    <div class="statusItem notificationsCount" style="display:{{zadanie.notyfikacjeDisplay}};">{{zadanie.notyfikacje}}</div>
                                </div>

                                <div class="taskTitle" style="margin-bottom:-10px;">{{zadanie.nazwa}}</div>
                                <div class="infoElements" ng-if="isAdmin(item.idProjekt)">
                                    <div class='icon {{zadanie.statusClass}}' ng-if="zadanie.priorytet!='prioFinished'">{{zadanie.statusUzytkownika}}</div>
                                    <div class='icon {{zadanie.statusClass}}' ng-if="zadanie.priorytet=='prioFinished'">zakończone</div>
                                    <div class='icon time'>{{zadanie.budzetGodzinowyWykorzystanie}}</div>
                                    <div class="clear" style="margin-bottom:5px;"></div>
                                    <div class='icon cost'>{{zadanie.budzetPienieznyWykorzystanie}}</div>
                                    <div class='icon promo'>{{zadanie.punktyPremioweWartosc}}</div>
                                </div>
                                <div class="infoElements" ng-if="!isAdmin(item.idProjekt)">
                                    <div class='icon {{zadanie.statusClass}}' ng-if="zadanie.priorytet!='prioFinished'">{{zadanie.statusUzytkownika}}</div>
                                    <div class='icon {{zadanie.statusClass}}' ng-if="zadanie.priorytet=='prioFinished'">zakończone</div>
                                    <div class='icon time'  ng-if="zadanie.osobaCzasTF==1">{{zadanie.osobaCzas}}</div>
                                    <div class="clear" style="margin-bottom:5px;"></div>
                                    <div class='icon cost' ng-if="zadanie.osobaKasaTF==1">{{zadanie.osobaKasa}}</div>
                                    <div class='icon promo'>{{zadanie.punktyPremioweWartosc}}</div>
                                </div>
                            </div>
                        </ons-col>
                        <ons-col ng-if="zadanie.milestone=='block'">
                            <div class="milestoneElement" style="display:{{zadanie.milestone}};">
                                <div class="milestoneHeader">{{zadanie.mileStoneNaglowek}}</div>
                                <div class="milerstoneDate">{{zadanie.data}}</div>
                                <div class="milerstoneDes">{{zadanie.nazwa}}</div>
                                <div class="charts">
                                    <span class="chartMini2" data-percent="{{zadanie.milestoneUkonczoneZadaniaProcent}}">
		                    <span class="percent"></span>
                                    </span>
                                    <div class="charMiniLabel">ukończone
                                        <br/>zadania</div>
                                    <span class="chartMini3" data-percent="{{zadanie.milestoneWykorzystanyBudzetPieniadze}}">
		                    <span class="percent"></span>
                                    </span>
                                    <div class="charMiniLabel">budżet
                                        <br/>pieniądze</div>
                                    <span class="chartMini4" data-percent="{{zadanie.milestoneWykorzystanyBudzetGodziny}}">
		                    <span class="percent"></span>
                                    </span>
                                    <div class="charMiniLabel">budżet
                                        <br/>godziny</div>
                                    <div class="clear"></div>
                                </div>
                                <div class="clear"></div>
                            </div>
                        </ons-col>
                    </ons-row>
                </ons-list-item>
            </ons-list>
            <div style="display:none;" class="tabBudzet" id="tabBudzet">
                <div class="chartsBig">
                    <div class="half" ng-if="item.budzetGodzinowy=='tak'">
                        <span class="chartHours" data-percent="{{item.budzetGodzinowyWykorzystanie/item.budzetGodzinowyWartosc*100}}">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.budzetGodzinowyWykorzystanie/60 | number : 2}}/{{item.budzetGodzinowyWartosc/60 | number : 0}}</span>
                        </span>
                        <div class="chartLabel">przepracowanych
                            <br/>godzin</div>
                    </div>
                    <div class="half" ng-if="item.budzetGodzinowy!='tak'">
                        <span class="chartHours" data-percent="0">
		                    <span class="value">{{item.budzetGodzinowyWykorzystanie/60 | number : 2}}</span>
                        <div class="clear"></div>

                        </span>
                        <div class="chartLabel">przepracowanych
                            <br/>godzin</div>
                    </div>
                    <div class="half" ng-if="item.budzetPieniezny=='tak'">
                        <span class="chartMoney" data-percent="{{item.budzetPienieznyWykorzystanie/item.budzetPienieznyWartosc*100}}">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.budzetPienieznyWykorzystanie/100 | number : 2}}/{{item.budzetPienieznyWartosc/100 | number : 0}}</span>
                        </span>
                        <div class="chartLabel">wykorzystane
                            <br/>pieniądze</div>
                    </div>
                    <div class="half" ng-if="item.budzetPieniezny!='tak'">
                        <span class="chartMoney" data-percent="{{item.budzetPienieznyWykorzystanie/item.budzetPienieznyWartosc*100}}">
		                    <span class="value">{{item.budzetPienieznyWykorzystanie/60 | number : 2}}zł</span>
                        <div class="clear"></div>
                        </span>
                        <div class="chartLabel">wykorzystane
                            <br/>pieniądze</div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="clear"></div>
                <ul class="list ">
                    <li class="list__header" id="budgetType">Koszty - zmień <i class="icon ion-android-arrow-dropdown"></i>
                    </li>
                    <ons-list-item modifier="chevron" class="item typeAll typeKoszt" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-kasaUzytkownika'" ng-click="showDetail($index)">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>

                                    </div>
                                    <div class="dateHolder prioFinished">
                                        <div class="day">0{{$index+1}}</div>
                                    </div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.kasaUzytkownika/100 | number:2}}zł</div>
                                    <div class="infoElements">
                                        <div class='icon time'>{{osoba.czasUzytkownika/60 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.kasaUzytkownika/100 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.stawka/100 | number:0}}</div>
                                        <div class='icon promo'>{{osoba.punktyUzytkownika}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                    <ons-list-item modifier="chevron" class="item typeAll typeCzas" style="display:none;" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-czasUzytkownika'" ng-click="showDetail($index)">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>

                                    </div>
                                    <div class="dateHolder prioFinished">
                                        <div class="day">0{{$index+1}}</div>
                                    </div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.czasUzytkownika/60 | number:2}}</div>
                                    <div class="infoElements">
                                        <div class='icon time'>{{osoba.czasUzytkownika/60 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.kasaUzytkownika/100 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.stawka/100 | number:0}}</div>
                                        <div class='icon promo'>{{osoba.punktyUzytkownika}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                    <ons-list-item modifier="chevron" class="item typeAll typePunkty" style="display:none;" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-punktyUzytkownika'" ng-click="showDetail($index)">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>

                                    </div>
                                    <div class="dateHolder prioFinished">
                                        <div class="day">0{{$index+1}}</div>
                                    </div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.punktyUzytkownika}}</div>
                                     <div class="infoElements">
                                        <div class='icon time'>{{osoba.czasUzytkownika/60 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.kasaUzytkownika/100 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.stawka/100 | number:0}}</div>
                                        <div class='icon promo'>{{osoba.punktyUzytkownika}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                    <ons-list-item modifier="chevron" class="item typeAll typeZadania" style="display:none;" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-iloscZadan'" ng-click="showDetail($index)">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>

                                    </div>
                                    <div class="dateHolder prioFinished">
                                        <div class="day">0{{$index+1}}</div>
                                    </div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.iloscZadan}}</div>
                                     <div class="infoElements">
                                        <div class='icon time'>{{osoba.czasUzytkownika/60 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.kasaUzytkownika/100 | number:2}}</div>
                                        <div class='icon cost'>{{osoba.stawka/100 | number:0}}</div>
                                        <div class='icon promo'>{{osoba.punktyUzytkownika}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                </ul>
            </div>
            <div style="display:none;" class="tabPostep">
                <div class="chartsBig">
                    <div class="half">
                        <span class="chartTask" ng-if="item.wszystkieZadania>0" data-percent="{{item.ukonczoneZadania/item.wszystkieZadania*100}}">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.ukonczoneZadania}}/{{item.wszystkieZadania}}</span>
                        </span>
                        <span class="chartTask" ng-if="item.wszystkieZadania==0" data-percent="0">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.ukonczoneZadania}}/{{item.wszystkieZadania}}</span>
                        </span>
                        <div class="chartLabel">wykonanych
                            <br/>zadań</div>
                    </div>
                    <div class="half">
                        <div class="statBigElement borderBottom">
                            <span class="stat-title">nieprzypisane zadania</span>
                            <div class="clear"></div>
                            {{item.zadaniaNieprzypisane}}
                        </div>
                        <div class="statBigElement borderBottom">
                            <span class="stat-title">zadania po terminie</span>
                            <div class="clear"></div>
                            {{item.zadaniaPoTerminie}}
                        </div>
                        <div class="statBigElement">
                            <span class="stat-title">zadania z przekroczonym budżetem</span>
                            <div class="clear"></div>
                            {{item.zadaniaPrzekroczonyBudzet}}
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="clear"></div>
                <ul class="list ">
                    <li class="list__header" ng-click="logType()">Wszystko - zmień <i class="icon ion-android-arrow-dropdown"></i>
                    </li>
                    <ons-list-item modifier="chevron" class="item typeLogAll typeKoszt" ng-repeat="logItem in item.log | orderBy:'-idLog' | logfilter:search">
                        <ons-row>
                            <div ng-if="logItem.typ=='koniecZadania'" class="width100">
                                <ons-col>
                                    <div class="basicItem logItem">
                                        <div class="avatarHolder">
                                            <div class="person" style="background-image:url({{logItem.avatarOsoby}})"></div>
                                            <div class="clear"></div>
                                        </div>
                                        <div class="actionButtonHolder" ng-if="!logItem.przyznanePunkty" data-id="{{logItem.idLog}}">
                                            <div class="addPromo" ng-click="addPromoPoints(logItem.idLog)"></div>
                                        </div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">Zakończenie zadania:</div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">{{logItem.nazwa}}</div>
                                        <div class="infoElements">
                                            <div class='icon none'>{{logItem.osoba}}</div>
                                            <div class='icon time'>{{logItem.data}}</div>
                                        </div>
                                        <div ng-if="logItem.przyznanePunkty" class="actionInfo" data-id="{{logItem.idLog}}">
                                            Przyznano punkty premiowe: <strong>{{logItem.przyznanePunkty}}</strong>
                                        </div>
                                    </div>
                                </ons-col>
                            </div>
                            <div ng-if="logItem.typ=='noweZadanie'" class="width100">
                                <ons-col>
                                    <div class="basicItem logItem">
                                        <div class="avatarHolder">
                                            <div class="person" style="background-image:url({{logItem.avatarOsoby}})"></div>
                                            <div class="clear"></div>
                                        </div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">Nowe zadanie:</div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">{{logItem.nazwa}}</div>
                                        <div class="infoElements">
                                            <div class='icon none'>{{logItem.osoba}}</div>
                                            <div class='icon time'>{{logItem.data}}</div>
                                        </div>

                                    </div>
                                </ons-col>
                            </div>
                            <div ng-if="logItem.typ=='zakonczenieProjektu'" class="width100">
                                <ons-col>
                                    <div class="basicItem logItem purple">
                                        <div class="taskTitle" style="margin-bottom:-10px;">Zakończenie projektu</div>
                                        <div class="infoElements">
                                            <div class='icon time'>{{logItem.data}}</div>
                                        </div>
                                    </div>
                                </ons-col>
                            </div>
                            <div ng-if="logItem.typ=='rozpoczecieProjektu'" class="width100">
                                <ons-col>
                                    <div class="basicItem logItem purple">
                                        <div class="taskTitle" style="margin-bottom:-10px;">Rozpoczęcie projektu</div>
                                        <div class="infoElements">
                                            <div class='icon time'>{{logItem.data}}</div>
                                        </div>
                                    </div>
                                </ons-col>
                            </div>
                            <div ng-if="logItem.typ=='zakonczenieMilestone'" class="width100">
                                <ons-col>
                                    <div class="basicItem logItem grey">
                                        <div class="taskTitle" style="margin-bottom:-10px;">Zakończenie milestone</div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">{{logItem.nazwa}}</div>
                                        <div class="infoElements">
                                            <div class='icon time'>{{logItem.data}}</div>
                                        </div>
                                    </div>
                                </ons-col>
                            </div>
                        </ons-row>
                    </ons-list-item>
                </ul>
            </div>
            <div style="display:none;" class="tabStatystyki">
                <div class="chartsBig">
                    <div class="half">
                        <span class="chartTask" ng-if="item.wszystkieZadania>0" data-percent="{{item.ukonczoneZadania/item.wszystkieZadania*100}}">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.ukonczoneZadania}}/{{item.wszystkieZadania}}</span>
                        </span>
                        <span class="chartTask" ng-if="item.wszystkieZadania==0" data-percent="0">
		                    <span class="percent"></span>
                        <div class="clear"></div>
                        <span class="detail">{{item.ukonczoneZadania}}/{{item.wszystkieZadania}}</span>
                        </span>
                        <div class="chartLabel">wykonanych
                            <br/>zadań</div>
                    </div>
                    <div class="half">
                        <div class="statBigElement borderBottom">
                            <span class="stat-title">nieprzypisane zadania</span>
                            <div class="clear"></div>
                            {{item.zadaniaNieprzypisane}}
                        </div>
                        <div class="statBigElement borderBottom">
                            <span class="stat-title">zadania po terminie</span>
                            <div class="clear"></div>
                            {{item.zadaniaPoTerminie}}
                        </div>
                        <div class="statBigElement">
                            <span class="stat-title">zadania z przekroczonym budżetem</span>
                            <div class="clear"></div>
                            {{item.zadaniaPrzekroczonyBudzet}}
                        </div>
                    </div>
                    <div class="clear"></div>
                </div>
                <div class="clear"></div>
                <ul class="list ">
                    <li class="list__header" >Punkty premiowe</li>
                    <ons-list-item modifier="chevron" class="item typeAll typePunkty" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-punktyUzytkownika'" ng-click="showDetail($index)">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem subtask" style="display:{{zadanie.basicItem}};">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>

                                    </div>
                                    <div class="dateHolder prioFinished">
                                        <div class="day">0{{$index+1}}</div>
                                    </div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.punktyUzytkownika}}</div>
                                    
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                </ul>
            </div>
        </ons-page>
    </ons-template>
    //FUTURE: Ekran ustawienia
    <ons-template id="settings.html" >
        <ons-page>
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button ng-click="updateUser()">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Ustawienia</div>
                <div class="right">
                    <ons-toolbar-button ng-click="logOut()">
                        <ons-icon icon="ion-log-out" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <div class="text-center" style="background-color:#32188f;">
                <div id="avatar" class="avatarUser" style="background-image:url('{{user.avatar}}');"></div>
                <a id="capturePhoto" data-attr="{{user.avatar}}">zmień awatar</a>
            </div>
            <ul class="list">
                <li class="list__header">Modyfikuj dane osobowe</li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Imię</ons-col>
                        <ons-col class="col ons-col-inner">
                            <input type="text" class="text-input text-input--transparent inputWithLabel" placeholder="Imię" ng-model="user.imie" ng-init="user.imie">
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Nazwisko</ons-col>
                        <ons-col class="col ons-col-inner">
                            <input type="text" class="text-input text-input--transparent inputWithLabel" placeholder="Nazwisko" ng-model="user.nazwisko" ng-init="user.nazwisko">
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
        </ons-page>
    </ons-template>
    //FUTURE: Ekran nowy projekt
    <ons-template id="newproject.html">
        <ons-page>
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Nowy projekt</div>
                <div class="right">
                    <ons-toolbar-button>
                        <ons-icon icon="ion-checkmark-circled" fixed-width="false" style="font-size: 26px; vertical-align: -4px" data-ng-click="addProject()"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <ul class="list">
                <li class="list__header">Informacje podstawowe</li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Nazwa*</ons-col>
                        <ons-col class="col ons-col-inner">
                            <input type="text" class="text-input text-input--transparent inputWithLabel" id="nazwaProjektu" placeholder="Nowy projekt">
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
            <ul class="list noOverscroll" id="terminy">
                <li class="list__header">Terminy</li>
            </ul>
            <div class="text-center">
                <div id="dodajTermin">dodaj termin</div>
            </div>
            <ul class="list ">
                <li class="list__header">Budżet</li>
                <li class="list__item" id="twojaStawkaGodzinowa">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Twoja stawka/h</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="1000" data-step="5" data-unit="zł">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Budżet pieniężny</ons-col>
                        <ons-col class="col ons-col-inner">
                            <div class="switchHolder">
                                <ons-switch id="budzetPieniadze"></ons-switch>
                            </div>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inactive" id="wartoscBudzetPieniadze">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="5000" data-step="250" data-unit="zł">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Budżet godzinowy</ons-col>
                        <ons-col class="col ons-col-inner">
                            <div class="switchHolder">
                                <ons-switch id="budzetGodzinowy"></ons-switch>
                            </div>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inactive" id="wartoscBudzetGodziny">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="1000" data-step="1" data-unit="h">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
        </ons-page>
    </ons-template>
    //FUTURE: Ekran nowe zadanie
    <ons-template id="newtask.html">
        <ons-page ng-controller="DetailController">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Nowe zadanie</div>
                <div class="right">
                    <ons-toolbar-button>
                        <ons-icon icon="ion-checkmark-circled" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="addNewTask()"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <ul class="list">
                <li class="list__header">Informacje podstawowe</li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Nazwa*</ons-col>
                        <ons-col class="col ons-col-inner flex2">
                            <input type="text" class="text-input text-input--transparent inputWithLabel" id="nazwaZadania" placeholder="Nowe zadanie">
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row class="row ons-row-inner">
                        <ons-col class="col ons-col-inner">Opis</ons-col>
                        <ons-col class="col ons-col-inner flex2">
                            <textarea class="text-input text-input--transparent inputWithLabel" id="opisZadania" placeholder="Dodatkowe informacje"></textarea>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row class="row ons-row-inner">
                        <ons-col class="col ons-col-inner">Miejsce</ons-col>
                        <ons-col class="col ons-col-inner flex2">
                            <span class="text-input text-input--transparent inputWithLabel" id="lokalizacjaZadania" onclick="navi.pushPage('map.html', { animation : 'slide' } )">Wybierz lokalizację</span><span id="lokalizacjaZadaniaLatLng" style="display:none;"></span>
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
            // TODO: Termin i priorytet
            <ul class="list noOverscroll" id="terminy">
                <li class="list__header">Termin i priorytet</li>
                <li class="list__item" id="wybranyTermin">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Termin</ons-col>
                        <ons-col class="col ons-col-inner flex2">
                            <select class="inputClear" id="wyborTerminu">
                                <option value="inny">Inna data</option>
                                <option ng-repeat="termin in item.terminy" value="{{termin.idTerminu}}">{{termin.data}} ({{termin.nazwa}})</option>
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inacive" id="innaData">
                    <ons-row align="center" class="row ons-row-inner row-center" style="padding-right:8px;">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner flex2" style="padding-right:20px;">
                            <input type="datetime-local" value="2015-12-00T12:00:00" step="1" class="inputClear" style="margin-right:20px;">
                        </ons-col>
                    </ons-row>
                </li>


                <li class="list__item" id="wybranyPriorytet">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Priorytet</ons-col>
                        <ons-col class="col ons-col-inner flex2">
                            <select class="inputClear">
                                <option value="niski">Niski</option>
                                <option value="normalny">Normalny</option>
                                <option value="wysoki">Wysoki</option>
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
            // TODO: Budzet
            <ul class="list">
                <li class="list__header">Budżet</li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Budżet pieniężny</ons-col>
                        <ons-col class="col ons-col-inner">
                            <div class="switchHolder">
                                <ons-switch id="zadanieCzyPieniadze" ng-click="switch('zadanieWartoscBudzetPieniadze')"></ons-switch>
                            </div>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inactive" id="zadanieWartoscBudzetPieniadze">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="1000" data-step="50" data-unit="zł" data-min="0" data-max="{{item.budzetPienieznyWartosc-item.budzetPienieznyWykorzystanie}}" data-select="50">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Budżet godzinowy</ons-col>
                        <ons-col class="col ons-col-inner">
                            <div class="switchHolder">
                                <ons-switch id="zadanieCzyGodziny" ng-click="switch('zadanieWartoscBudzetGodziny')"></ons-switch>
                            </div>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inactive" id="zadanieWartoscBudzetGodziny">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="1000" data-step="1" data-unit="h" data-max="{{item.budzetGodzinowyWartosc-item.budzetGodzinowyWykorzystanie}}">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Punkty premiowe</ons-col>
                        <ons-col class="col ons-col-inner">
                            <div class="switchHolder">
                                <ons-switch id="czyPunktyPremiowe" ng-click="switch('zadanieWartoscPunktyPremiowe')"></ons-switch>
                            </div>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item inactive" id="zadanieWartoscPunktyPremiowe">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Wartość</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select class="inputClear optionGenerator" data-count="5" data-step="1" data-unit="">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
            <ul class="list" id="personList">
                <li class="list__header">Osoby</li>
                <ons-list-item modifier="chevron" class="item osoba" ng-repeat="osoba in currentuser[0].tmp | orderBy:'-imie'" data-person="{{osoba.idUser}}" ng-click="removePersonFromTask(osoba.idUser)">
                    <ons-row>
                        <ons-col>
                            <div class="basicItem logItem">
                                <div class="avatarHolder">
                                    <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                    <div class="clear"></div>
                                </div>
                                <div ng-if="userAddedToTemp(osoba.idUser)" class="checkHolder"><i class="icon ion-android-cancel"></i></div>
                                <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                <div class="infoElements">
                                    <div class='icon cost'>{{osoba.stawka}}</div>
                                </div>
                            </div>
                        </ons-col>
                    </ons-row>
                </ons-list-item>
            </ul>

            <div class="text-center">
                <div id="dodajOsobe" onclick="navi.pushPage('addperson.html', { animation : 'slide' } )">dodaj osobę</div>
            </div>
        </ons-page>
    </ons-template>
    //FUTURE: Dodaj osobe
    <ons-template id="addperson.html">
        <ons-page ng-controller="DetailController">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Dodaj osobę</div>
                <div class="right">
                </div>
            </ons-toolbar>
            <ul class="list" id="personToAddList">
                <ons-list-item modifier="chevron" class="item osoba" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'-imie'" data-person="{{osoba.idUser}}" ng-click="addPersonToTask(osoba.idUser)">
                    <ons-row>
                        <ons-col>
                            <div class="basicItem logItem">
                                <div class="avatarHolder">
                                    <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                    <div class="clear"></div>
                                </div>
                                <div ng-if="userAddedToTemp(osoba.idUser)" class="checkHolder"><i class="icon ion-checkmark-circled"></i></div>
                                <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                <div class="infoElements">
                                    <div class='icon cost'>{{osoba.stawka}}</div>
                                </div>
                            </div>
                        </ons-col>
                    </ons-row>
                </ons-list-item>
            </ul>
        </ons-page>
    </ons-template>
    //FUTURE: Ekran mapa
    <ons-template id="map.html">
        <ons-page ng-controller="DetailController" ng-init="initMap()">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button ng-click="applyLocation()">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Lokalizacja</div>
                <div class="right">
                </div>
            </ons-toolbar>
            <script type="text/javascript" src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDt3cHxEr4IhF8HFs7cgjvl7qnRD9hmGso&libraries=places"></script>
            <link href="http://code.google.com/apis/maps/documentation/javascript/examples/default.css" rel="stylesheet" type="text/css" />
            <input id="pac-input" class="controls" type="text" placeholder="Wyśrodkuj mapę na...">
            <div id="map_canvas" style="width:100%; height:450px;">
            </div>
            <div class="locationBig">
                <h3>Lokalizacja:</h3>
                <div id="adressPreview">Kliknij na mapie, by wybrać lokalizację</div>
            </div>
        </ons-page>
    </ons-template>

    //FUTURE: Edytuj osoby
    <ons-template id="editPeople.html">
        <ons-page ng-controller="DetailController">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Osoby</div>
                <div class="right">
                </div>
            </ons-toolbar>
            <ons-tapbar position="top" class="homeTabs">
                <div class="tab-bar tab-bar--top tab-bar--top-border">
                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToPersonListTab()">
                        <input type="radio" name="top-tab-bar-b" checked="checked">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Dodane
                        </button>
                    </label>

                    <label class="tab-bar__item tab-bar--top-border__item" ng-click="goToAddNewPersonTab()">
                        <input type="radio" name="top-tab-bar-b">
                        <button class="tab-bar__button tab-bar--top-border__button">
                            Dodaj nową
                        </button>
                    </label>
                </div>
            </ons-tapbar>


            <div>

                <div id="currentProjectPeopleTab">
                    <ons-list-item modifier="chevron" class="item osoba" ng-repeat="osoba in item.przypisaneOsoby | orderBy:'imie' " data-person="{{osoba.idUser}}" style="background:#FFF;">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem logItem">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>
                                    </div>
                                    <div ng-if="userNoTask(osoba.idUser) && !isAdmin(item.idProjekt)" class="checkHolder" ng-click="removePerson(osoba.idUser)"><i class="icon ion-android-cancel"></i></div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                    <div class="infoElements">
                                        <div class='icon cost'>{{osoba.stawka/100 | number:0 }}zł/h</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                </div>

                <div id="addNewPersonTab" style="display:none;">
                    <div class="searchbar">
                        <div class="loopIcon"></div>
                        <input ng-model="searchText" id="searchPerson" placeholder="Wyszukaj przez e-mail">
                    </div>

                    <div id="lastUsedPeople">
                        <h3>Ostatnio pracowałeś z:</h3>
                        <ons-list-item modifier="chevron" class="item osoba" ng-repeat="osoba in currentuser[0].ostatnieOsoby | orderBy:'imie' " data-person="{{osoba.idUser}}" ng-click="addPersonLast(osoba.idUser)" style="background:#FFF;">
                            <ons-row>
                                <ons-col>
                                    <div class="basicItem logItem">
                                        <div class="avatarHolder">
                                            <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                            <div class="clear"></div>
                                        </div>
                                        <div ng-if="userAdded(osoba.idUser)" class="checkHolder"><i class="icon ion-checkmark-circled"></i></div>
                                        <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imie}}</div>
                                        <div class="infoElements">
                                            <div class='icon cost'>{{osoba.stawka/100 | number:0 }}zł/h</div>
                                        </div>
                                    </div>
                                </ons-col>
                            </ons-row>
                        </ons-list-item>
                    </div>
                    <div id="searchPeople" style="display:none;" />
                    <ons-list-item modifier="chevron" class="item osoba" ng-repeat="osoba in baza | orderBy:'imie' | filter:searchText" data-person="{{osoba.idUser}}" ng-click="addPersonNew(osoba.idUser)" style="background:#FFF;">
                        <ons-row>
                            <ons-col>
                                <div class="basicItem logItem">
                                    <div class="avatarHolder">
                                        <div class="person" style="background-image:url({{osoba.avatar}})"></div>
                                        <div class="clear"></div>
                                    </div>
                                    <div ng-if="userAdded(osoba.idUser)" class="checkHolder"><i class="icon ion-checkmark-circled"></i></div>
                                    <div class="taskTitle" style="margin-bottom:-10px;">{{osoba.imienazwisko}}</div>
                                    <div class="infoElements">
                                        <div class='icon none'>{{osoba.email}}</div>
                                    </div>
                                </div>
                            </ons-col>
                        </ons-row>
                    </ons-list-item>
                </div>
            </div>
            </div>

        </ons-page>
    </ons-template>

    //FUTURE: Ekran edytuj terminy
    <ons-template id="editTerms.html">
        <ons-page ng-controller="DetailController">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Terminy</div>
                <div class="right">
                    <ons-toolbar-button>
                        <ons-icon icon="ion-checkmark-circled" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="updateTerms()"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>

            <li ng-repeat="termin in item.terminy" class="list__item pojedynczyTermin" style="padding-right:8px; background-color:#FFF;" data-termid="{{termin.idTerminu}} ">
                <div class="removeTerm" ng-click="removeTerm(termin.idTerminu)"><i class="icon ion-android-cancel"></i></div>
                <ons-row align="center" class="row ons-row-inner row-center" style="padding-right:1px;">
                    <ons-col class="col ons-col-inner">Data</ons-col>
                    <ons-col class="col ons-col-inner" style="padding-right:8px;">{{termin.data}}</ons-col>
                </ons-row>
                <ons-row align="center" class="row ons-row-inner row-center">
                    <ons-col class="col ons-col-inner">Nazwa</ons-col>
                    <ons-col class="col ons-col-inner">{{termin.nazwa}} </ons-col>
                </ons-row>
            </li>



            <ul class="list noOverscroll" id="terminyNowe">
            </ul>
            <div class="text-center">
                <div id="dodajTerminNowy" ng-click="addTermTemplate()">dodaj termin</div>
            </div>

        </ons-page>
    </ons-template>

    //FUTURE: Ekran edytuj budżet
    <ons-template id="editBudget.html">
        <ons-page ng-controller="DetailController">
            <ons-toolbar>
                <div class="left">
                    <ons-toolbar-button onclick="navi.popPage();">
                        <ons-icon icon="ion-chevron-left" fixed-width="false" style="font-size: 26px; vertical-align: -4px"></ons-icon>
                    </ons-toolbar-button>
                </div>
                <div class="center">Budżet</div>
                <div class="right">
                    <ons-toolbar-button>
                        <ons-icon icon="ion-checkmark-circled" fixed-width="false" style="font-size: 26px; vertical-align: -4px" ng-click="updateBudget()"></ons-icon>
                    </ons-toolbar-button>
                </div>
            </ons-toolbar>
            <div class="chartsBig" id="editBudgetCharts" ng-init="initBudgetCharts()">
                <div class="half" ng-if="item.budzetGodzinowy=='tak'">
                    <span class="chartHours" data-percent="{{item.budzetGodzinowyWykorzystanie/item.budzetGodzinowyWartosc*100}}">
		                    <span class="percent"></span>
                    <div class="clear"></div>
                    <span class="detail">{{item.budzetGodzinowyWykorzystanie/60 | number:0}}/<span id="newHourBudgetText">{{item.budzetGodzinowyWartosc/60 | number:0}}</span></span>
                    </span>
                    <div class="chartLabel">przepracowanych
                        <br/>godzin</div>
                </div>
                <div class="half" ng-if="item.budzetGodzinowy!='tak'">
                    <span class="chartHours" data-percent="0">
		                    <span class="value">{{item.budzetGodzinowyWykorzystanie/60 | number:0}}</span>
                    <div class="clear"></div>

                    </span>
                    <div class="chartLabel">przepracowanych
                        <br/>godzin</div>
                </div>
                <div class="half" ng-if="item.budzetPieniezny=='tak'">
                    <span class="chartMoney" data-percent="{{item.budzetPienieznyWykorzystanie/item.budzetPienieznyWartosc*100}}">
		                    <span class="percent"></span>
                    <div class="clear"></div>
                    <span class="detail">{{item.budzetPienieznyWykorzystanie/100 | number:0}}/<span id="newMoneyBudgetText">{{item.budzetPienieznyWartosc/100 | number:0}}</span></span>
                    </span>
                    <div class="chartLabel">wykorzystane
                        <br/>pieniądze</div>
                </div>
                <div class="half" ng-if="item.budzetPieniezny!='tak'">
                    <span class="chartMoney" data-percent="{{item.budzetPienieznyWykorzystanie/item.budzetPienieznyWartosc*100}}">
		                    <span class="value">{{item.budzetPienieznyWykorzystanie/100 | number:0}}zł</span>
                    <div class="clear"></div>
                    </span>
                    <div class="chartLabel">wykorzystane
                        <br/>pieniądze</div>
                </div>
                <div class="clear"></div>
            </div>
            <ul class="list ">
                <li class="list__header">Budżet</li>
                <li class="list__item" ng-if="item.budzetPieniezny=='tak'">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Pieniądze</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select id="newMoneyBudget" class="inputClear optionGenerator" data-count="1000" data-step="250" data-unit="zł" data-min="{{item.budzetPienieznyWykorzystanie}}" data-select="{{item.budzetPienieznyWartosc}}">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
                <li class="list__item" ng-if="item.budzetGodzinowy=='tak'">
                    <ons-row align="center" class="row ons-row-inner row-center">
                        <ons-col class="col ons-col-inner">Godziny</ons-col>
                        <ons-col class="col ons-col-inner">
                            <select id="newHourBudget" class="inputClear optionGenerator" data-count="5000" data-step="1" data-unit="h" data-min="{{item.budzetGodzinowyWykorzystanie}}" data-select="{{item.budzetGodzinowyWartosc}}">
                            </select>
                        </ons-col>
                    </ons-row>
                </li>
            </ul>
        </ons-page>
    </ons-template>


    <script>
        var projectCreated = 0;
        jQuery(document).ready(function ($) {



            function convertToDataURLviaCanvas(url, callback, outputFormat) {
                var img = new Image();
                img.crossOrigin = 'Anonymous';
                img.onload = function () {
                    var canvas = document.createElement('CANVAS');
                    var ctx = canvas.getContext('2d');
                    var dataURL;
                    canvas.height = this.height * 0.1;
                    canvas.width = this.width * 0.1;
                    ctx.translate(canvas.width / 2, canvas.height / 2);
                    ctx.rotate(90 * Math.PI / 180);
                    ctx.translate(-canvas.width / 2, -canvas.height / 2);
                    ctx.drawImage(this, 0, 0, canvas.width, canvas.height);
                    dataURL = canvas.toDataURL(outputFormat);
                    callback(dataURL);
                    canvas = null;
                };
                img.src = url;
            }


            // Funkcje dla podstron
            function captureSuccess(mediaFiles) {
                var i, len;
                for (i = 0, len = mediaFiles.length; i < len; i += 1) {
                    var obrazek = document.getElementById('avatar');
                    avatrUzytkownika = mediaFiles[i].fullPath;
                    convertToDataURLviaCanvas(avatrUzytkownika, function (base64Img) {
                        avatrUzytkownika = base64Img;
                        $('.avatarUser').css('background-image', 'url(' + base64Img + ')');
                        $('#capturePhoto').attr('data-avatar',base64Img);
                        
                    });
                }
            }

            function captureImage() {
                navigator.device.capture.captureImage(captureSuccess, console.log("capture"), {
                    limit: 1
                });
            }
            ons.ready(function () {
                navi.on('postpop', function () {
                    var newpercent
                    if ($('.chartMoney').find('canvas').length) {
                        newpercent = $('.chartMoney').attr('data-percent');
                        $('.chartMoney').data('easyPieChart').update(newpercent);
                    }
                    if ($('.chartHours').find('canvas').length) {
                        newpercent = $('.chartHours').attr('data-percent');
                        $('.chartHours').data('easyPieChart').update(newpercent);
                    }

                    if ($('.chartTask').find('canvas').length) {
                        newpercent = $('.chartTask').attr('data-percent');
                        $('.chartTask').data('easyPieChart').update(newpercent);
                    }

                    $('#tabZadania .chartMini2').each(function (e) {
                        if ($(this).find('canvas').length) {
                            newpercent = $(this).attr('data-percent');
                            $(this).data('easyPieChart').update(newpercent);
                        } else {
                            $(this).easyPieChart({
                                size: 50,
                                lineWidth: 3,
                                barColor: '#25007C',
                                trackColor: '#F7F7F7',
                                scaleColor: '#FAFAFD',
                                lineCap: 'square',
                                easing: 'easeOutBounce',
                                onStep: function (from, to, percent) {
                                    $(this.el).find('.percent').text(Math.round(percent));
                                }
                            });
                        }
                    });

                    $('#tabZadania .chartMini3').each(function (e) {
                        if ($(this).find('canvas').length) {
                            newpercent = $(this).attr('data-percent');
                            $(this).data('easyPieChart').update(newpercent);
                        } else {
                            $(this).easyPieChart({
                                size: 50,
                                lineWidth: 3,
                                barColor: '#E32C35',
                                trackColor: '#F7F7F7',
                                scaleColor: '#FAFAFD',
                                lineCap: 'square',
                                easing: 'easeOutBounce',
                                onStep: function (from, to, percent) {
                                    $(this.el).find('.percent').text(Math.round(percent));
                                }
                            });
                        }
                    });

                    $('#tabZadania .chartMini4').each(function (e) {
                        if ($(this).find('canvas').length) {
                            newpercent = $(this).attr('data-percent');
                            $(this).data('easyPieChart').update(newpercent);
                        } else {
                            $(this).easyPieChart({
                                size: 50,
                                lineWidth: 3,
                                barColor: '#7ABC32',
                                trackColor: '#F7F7F7',
                                scaleColor: '#FAFAFD',
                                lineCap: 'square',
                                easing: 'easeOutBounce',
                                onStep: function (from, to, percent) {
                                    $(this.el).find('.percent').text(Math.round(percent));
                                }
                            });

                        }
                    });
                });


                navi.on('postpush', function () {


                    $('#searchPerson').on("change keyup paste", function () {
                        if ($('#searchPerson').val().length > 2) {
                            $('#lastUsedPeople').css('display', 'none');
                            $('#searchPeople').css('display', 'block');
                        } else {
                            $('#lastUsedPeople').css('display', 'block');
                            $('#searchPeople').css('display', 'none');
                        }
                    });

                    //TODO: optionGenerator JS
                    $('select.optionGenerator').each(function () {
                        if ($(this).find('option').length == 0) {
                            var count = $(this).attr('data-count');
                            var step = $(this).attr('data-step');
                            var unit = $(this).attr('data-unit');
                            var select = $(this).attr('data-select');
                            var min = $(this).attr('data-min');
                            var multi=1;
                            if (unit=="h") { multi=60; }
                            if (unit=="zł") { multi=100; }
                            if (typeof min == typeof undefined || min == false) {
                                min = 0;
                            }
                            var max = $(this).attr('data-max');
                            if (typeof max == typeof undefined || max == false) {
                                max = 10000000000000;
                            }
                            var stringtt = '';
                            console.log(new Date());
                            for (i = 1; i <= count; i++) {
                                if ((step * i * multi) >= min && (step * i * multi) <= max) {
                                    if (step * i * multi== select) {
                                        stringtt += '<option value="' + (step * i * multi) + '"  selected="selected">' + (step * i) + unit + '</option>';
                                    } else {
                                        stringtt += '<option value="' + (step * i * multi) + '">' + (step * i) + unit + '</option>';
                                    }
                                }
                            }
                            $(this).append(stringtt);
                            console.log(new Date());
                        }
                    });



                  
                    $('#goToProjekty').click(function () {
                        $('.tabMojeZadania').css('display', 'none');
                        $('.tabProjekty').css('display', 'block');

                    });

                    $('#goToZadania').click(function () {
                        $('.tabZadania').css('display', 'block');
                        $('.tabPostep').css('display', 'none');
                        $('.tabBudzet').css('display', 'none');
                        $('.tabStatystyki').css('display', 'none');
                        $('.emptyAll').css('display', 'block');

                    });

                    $('#goToBudzet').click(function () {
                        $('.tabZadania').css('display', 'none');
                        $('.tabPostep').css('display', 'none');
                        $('.tabBudzet').css('display', 'block');
                        $('.emptyAll').css('display', 'none');
                        $('.chartHours').easyPieChart({
                            size: 148,
                            lineWidth: 5,
                            barColor: '#7ABC32',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                        $('.chartMoney').easyPieChart({
                            size: 148,
                            lineWidth: 5,
                            barColor: '#E32C35',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });
                    });

                    $('#editBudgetCharts .chartHours').easyPieChart({
                        size: 148,
                        lineWidth: 5,
                        barColor: '#7ABC32',
                        trackColor: '#F7F7F7',
                        scaleColor: '#FAFAFD',
                        lineCap: 'square',
                        easing: 'easeOutBounce',
                        onStep: function (from, to, percent) {
                            $(this.el).find('.percent').text(Math.round(percent));
                        }
                    });

                    $('#editBudgetCharts .chartMoney').easyPieChart({
                        size: 148,
                        lineWidth: 5,
                        barColor: '#E32C35',
                        trackColor: '#F7F7F7',
                        scaleColor: '#FAFAFD',
                        lineCap: 'square',
                        easing: 'easeOutBounce',
                        onStep: function (from, to, percent) {
                            $(this.el).find('.percent').text(Math.round(percent));
                        }
                    });

                    $('#taskCharts .chartHours').easyPieChart({
                        size: 148,
                        lineWidth: 5,
                        barColor: '#7ABC32',
                        trackColor: '#F7F7F7',
                        scaleColor: '#FAFAFD',
                        lineCap: 'square',
                        easing: 'easeOutBounce',
                        onStep: function (from, to, percent) {
                            $(this.el).find('.percent').text(Math.round(percent));
                        }
                    });

                    $('#taskCharts .chartMoney').easyPieChart({
                        size: 148,
                        lineWidth: 5,
                        barColor: '#E32C35',
                        trackColor: '#F7F7F7',
                        scaleColor: '#FAFAFD',
                        lineCap: 'square',
                        easing: 'easeOutBounce',
                        onStep: function (from, to, percent) {
                            $(this.el).find('.percent').text(Math.round(percent));
                        }
                    });




                    $("#newHourBudget").change(function () {
                        var min = $(this).attr('data-min');
                        var max = $(this).find("option:selected").val();
                        min = Math.floor(min / max * 100);
                        $('#newHourBudgetText').text(max/60);
                        $('#editBudgetCharts .chartHours').data('easyPieChart').update(min);
                    });

                    $("#newMoneyBudget").change(function () {
                        var min = $(this).attr('data-min');
                        var max = $(this).find("option:selected").val();
                        min = Math.floor(min / max * 100);
                        $('#newMoneyBudgetText').text(max/100);
                        $('#editBudgetCharts .chartMoney').data('easyPieChart').update(min);
                    });



                    // TODO: zmiana terminu
                    $("#wyborTerminu").change(function () {
                        var tamp = $(this).find("option:selected").val();
                        if (tamp == "inny") {
                            $('#innaData').removeClass('inactive');
                        } else {
                            $('#innaData').addClass('inactive');
                        }
                    });






                    $('#goToPostep').click(function () {
                        $('.tabZadania').css('display', 'none');
                        $('.tabPostep').css('display', 'block');
                        $('.tabBudzet').css('display', 'none');
                        $('.emptyAll').css('display', 'none');
                        $('.chartTask').easyPieChart({
                            size: 148,
                            lineWidth: 5,
                            barColor: '#25007C',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });
                    });
                    
                       $('#goToStatystyki').click(function () {
                        $('.tabZadania').css('display', 'none');
                        $('.tabPostep').css('display', 'none');
                        $('.tabStatystyki').css('display', 'block');
                        $('.tabBudzet').css('display', 'none');
                        $('.emptyAll').css('display', 'none');
                        $('.chartTask').easyPieChart({
                            size: 148,
                            lineWidth: 5,
                            barColor: '#25007C',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });
                    });


                    $('#goToDashboard').click(function () {
                        $('.page__background').toggleClass('simpleBG');
                        $('.tabMojeZadania').css('display', 'none');
                        $('.tabProjekty').css('display', 'none');
                        $('.homeTabs').css('display', 'none');
                        $(this).css('display', 'none');
                        $('.tabDashboard').css('overflow', 'initial');
                        $('.tabDashboard').css('height', 'auto');
                        $('#goToList').css('display', 'inline-block');
                        $('.chart').easyPieChart({
                            size: 230,
                            lineWidth: 6,
                            barColor: '#FFD100',
                            trackColor: '#1E1052',
                            scaleColor: '#32188f',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                    });

                    $('#goToList').click(function () {
                        $('.page__background').toggleClass('simpleBG');
                        $('.tabMojeZadania').css('display', 'none');
                        $('.tabProjekty').css('display', 'block');
                        $('.homeTabs').css('display', 'block');
                        $(this).css('display', 'none');
                        $('.tabDashboard').css('overflow', 'hidden');
                        $('.tabDashboard').css('height', '1px');
                        $('#goToDashboard').css('display', 'inline-block');

                    });
                    $(function () {

                        $('.chartMini').easyPieChart({
                            size: 50,
                            lineWidth: 3,
                            barColor: '#25007C',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                        $('.chartMini2').easyPieChart({
                            size: 50,
                            lineWidth: 3,
                            barColor: '#25007C',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                        $('.chartMini3').easyPieChart({
                            size: 50,
                            lineWidth: 3,
                            barColor: '#E32C35',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                        $('.chartMini4').easyPieChart({
                            size: 50,
                            lineWidth: 3,
                            barColor: '#7ABC32',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });


                    });

                    function reChart() {
                        $('.chart').easyPieChart({
                            size: 230,
                            lineWidth: 6,
                            barColor: '#FFD100',
                            trackColor: '#1E1052',
                            scaleColor: '#32188f',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });

                        $('.chartMini').easyPieChart({
                            size: 50,
                            lineWidth: 3,
                            barColor: '#25007C',
                            trackColor: '#F7F7F7',
                            scaleColor: '#FAFAFD',
                            lineCap: 'square',
                            easing: 'easeOutBounce',
                            onStep: function (from, to, percent) {
                                $(this.el).find('.percent').text(Math.round(percent));
                            }
                        });
                    }

                    $('#budgetType').click(function () {
                        ons.notification.confirm({
                            title: 'Opcje projektu',
                            message: "co chcesz zrobić?",
                            buttonLabels: [
      'Koszty',
      'Przepracowane godziny',
      'Przypisane zadania',
        'Punkty premiowe'
    ],
                            primaryButtonIndex: 0,
                            callback: function (index) {
                                if (index == 0) {
                                    $('.typeAll').css('display', 'none');
                                    $('.typeKoszt').css('display', 'block');
                                    $('.typeKoszt').addClass('blink');
                                    $('#budgetType').html('Koszty - zmień <i class="icon ion-android-arrow-dropdown"></i>');
                                }
                                if (index == 1) {
                                    $('.typeAll').css('display', 'none');
                                    $('.typeCzas').css('display', 'block');
                                    $('.typeCzas').addClass('blink');
                                    $('#budgetType').html('Przepracowane godziny - zmień <i class="icon ion-android-arrow-dropdown"></i>');
                                }
                                if (index == 2) {
                                    $('.typeAll').css('display', 'none');
                                    $('.typeZadania').css('display', 'block');
                                    $('.typeZadania').addClass('blink');
                                    $('#budgetType').html('Przypisane zadania - zmień <i class="icon ion-android-arrow-dropdown"></i>');
                                }
                                if (index == 3) {
                                    $('.typeAll').css('display', 'none');
                                    $('.typePunkty').css('display', 'block');
                                    $('.typePunkty').addClass('blink');
                                    $('#budgetType').html('Punkty premiowe - zmień <i class="icon ion-android-arrow-dropdown"></i>');
                                }
                            }
                        });
                    });

                    // Nowy projekt 
                    // TODO: switch JS
                    $('#newTask').fadeIn();

                    $('#budzetGodzinowy').click(function () {
                        $('#wartoscBudzetGodziny').toggleClass('inactive');
                    });
                    $('#budzetPieniadze').click(function () {
                        $('#wartoscBudzetPieniadze').toggleClass('inactive');
                    });

                    $('.connectedSwitch').click(function () {
                        var tmp = $(this).attr('data-connected');
                        $('#' + tmp).toggleClass('inactive');
                    });

                    var animationCount = 0;
                    $('#dodajTermin').click(function () {
                        if (animationCount == 0) {
                            $(this).removeClass('blink');
                            $(this).addClass('blink2');
                            animationCount++;
                        } else {
                            $(this).removeClass('blink2');
                            $(this).addClass('blink');
                            animationCount = 0;
                        }
                        var item = $('<li class="list__item pojedynczyTermin" style="padding-right:8px; display:none;"><ons-row align="center" class="row ons-row-inner row-center" style="padding-right:1px;"><ons-col class="col ons-col-inner">Data*</ons-col><ons-col class="col ons-col-inner" style="padding-right:8px;"><input type="datetime-local"  class="inputClear" value="' + new Date().toJSON().slice(0, 19) + '" ></ons-col></ons-row><ons-row align="center" class="row ons-row-inner row-center"><ons-col class="col ons-col-inner">Nazwa*</ons-col><ons-col class="col ons-col-inner"><input type="text" class="text-input text-input--transparent inputWithLabel" placeholder="Nazwa terminu"></ons-col></ons-row></li>');
                        $('#terminy').append(item);
                        $(item).fadeIn(2000);
                    });

                    $('#capturePhoto').click(function () {
                        captureImage();
                    });
                });
            });
        });
    </script>
</body>

</html>